(function() {
  var SelectStageHunkFiles, SelectStageHunks, fs, git, pathToRepoFile, repo, _ref;

  fs = require('fs-plus');

  git = require('../../lib/git');

  _ref = require('../fixtures'), repo = _ref.repo, pathToRepoFile = _ref.pathToRepoFile;

  SelectStageHunkFiles = require('../../lib/views/select-stage-hunk-file-view');

  SelectStageHunks = require('../../lib/views/select-stage-hunks-view');

  describe("SelectStageHunkFiles", function() {
    return it("gets the diff of the selected file", function() {
      var fileItem, view;
      spyOn(git, 'diff').andReturn(Promise.resolve(''));
      fileItem = {
        path: pathToRepoFile
      };
      view = new SelectStageHunkFiles(repo, [fileItem]);
      view.confirmSelection();
      return expect(git.diff).toHaveBeenCalledWith(repo, pathToRepoFile);
    });
  });

  describe("SelectStageHunks", function() {
    return it("stages the selected hunk", function() {
      var hunk, patch_path, view;
      spyOn(git, 'cmd').andReturn(Promise.resolve(''));
      spyOn(fs, 'unlink');
      spyOn(fs, 'writeFile').andCallFake(function() {
        return fs.writeFile.mostRecentCall.args[3]();
      });
      hunk = {
        match: function() {
          return [1, 'this is a diff', 'hunk'];
        }
      };
      view = new SelectStageHunks(repo, ["patch_path hunk1", hunk]);
      patch_path = repo.getWorkingDirectory() + '/GITPLUS_PATCH';
      view.confirmSelection();
      view.find('.btn-stage-button').click();
      return expect(git.cmd).toHaveBeenCalledWith(['apply', '--cached', '--', patch_path], {
        cwd: repo.getWorkingDirectory()
      });
    });
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL2Rhd3NvbmJvdHNmb3JkLy5hdG9tL3BhY2thZ2VzL2dpdC1wbHVzL3NwZWMvdmlld3Mvc2VsZWN0LXN0YWdlLWh1bmstZmlsZXMtdmlldy1zcGVjLmNvZmZlZSIKICBdLAogICJuYW1lcyI6IFtdLAogICJtYXBwaW5ncyI6ICJBQUFBO0FBQUEsTUFBQSwyRUFBQTs7QUFBQSxFQUFBLEVBQUEsR0FBSyxPQUFBLENBQVEsU0FBUixDQUFMLENBQUE7O0FBQUEsRUFDQSxHQUFBLEdBQU0sT0FBQSxDQUFRLGVBQVIsQ0FETixDQUFBOztBQUFBLEVBRUEsT0FBeUIsT0FBQSxDQUFRLGFBQVIsQ0FBekIsRUFBQyxZQUFBLElBQUQsRUFBTyxzQkFBQSxjQUZQLENBQUE7O0FBQUEsRUFHQSxvQkFBQSxHQUF1QixPQUFBLENBQVEsNkNBQVIsQ0FIdkIsQ0FBQTs7QUFBQSxFQUlBLGdCQUFBLEdBQW1CLE9BQUEsQ0FBUSx5Q0FBUixDQUpuQixDQUFBOztBQUFBLEVBTUEsUUFBQSxDQUFTLHNCQUFULEVBQWlDLFNBQUEsR0FBQTtXQUMvQixFQUFBLENBQUcsb0NBQUgsRUFBeUMsU0FBQSxHQUFBO0FBQ3ZDLFVBQUEsY0FBQTtBQUFBLE1BQUEsS0FBQSxDQUFNLEdBQU4sRUFBVyxNQUFYLENBQWtCLENBQUMsU0FBbkIsQ0FBNkIsT0FBTyxDQUFDLE9BQVIsQ0FBZ0IsRUFBaEIsQ0FBN0IsQ0FBQSxDQUFBO0FBQUEsTUFDQSxRQUFBLEdBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxjQUFOO09BRkYsQ0FBQTtBQUFBLE1BR0EsSUFBQSxHQUFXLElBQUEsb0JBQUEsQ0FBcUIsSUFBckIsRUFBMkIsQ0FBQyxRQUFELENBQTNCLENBSFgsQ0FBQTtBQUFBLE1BSUEsSUFBSSxDQUFDLGdCQUFMLENBQUEsQ0FKQSxDQUFBO2FBS0EsTUFBQSxDQUFPLEdBQUcsQ0FBQyxJQUFYLENBQWdCLENBQUMsb0JBQWpCLENBQXNDLElBQXRDLEVBQTRDLGNBQTVDLEVBTnVDO0lBQUEsQ0FBekMsRUFEK0I7RUFBQSxDQUFqQyxDQU5BLENBQUE7O0FBQUEsRUFlQSxRQUFBLENBQVMsa0JBQVQsRUFBNkIsU0FBQSxHQUFBO1dBQzNCLEVBQUEsQ0FBRywwQkFBSCxFQUErQixTQUFBLEdBQUE7QUFDN0IsVUFBQSxzQkFBQTtBQUFBLE1BQUEsS0FBQSxDQUFNLEdBQU4sRUFBVyxLQUFYLENBQWlCLENBQUMsU0FBbEIsQ0FBNEIsT0FBTyxDQUFDLE9BQVIsQ0FBZ0IsRUFBaEIsQ0FBNUIsQ0FBQSxDQUFBO0FBQUEsTUFDQSxLQUFBLENBQU0sRUFBTixFQUFVLFFBQVYsQ0FEQSxDQUFBO0FBQUEsTUFFQSxLQUFBLENBQU0sRUFBTixFQUFVLFdBQVYsQ0FBc0IsQ0FBQyxXQUF2QixDQUFtQyxTQUFBLEdBQUE7ZUFDakMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSyxDQUFBLENBQUEsQ0FBakMsQ0FBQSxFQURpQztNQUFBLENBQW5DLENBRkEsQ0FBQTtBQUFBLE1BSUEsSUFBQSxHQUNFO0FBQUEsUUFBQSxLQUFBLEVBQU8sU0FBQSxHQUFBO2lCQUFHLENBQUMsQ0FBRCxFQUFJLGdCQUFKLEVBQXNCLE1BQXRCLEVBQUg7UUFBQSxDQUFQO09BTEYsQ0FBQTtBQUFBLE1BTUEsSUFBQSxHQUFXLElBQUEsZ0JBQUEsQ0FBaUIsSUFBakIsRUFBdUIsQ0FBQyxrQkFBRCxFQUFxQixJQUFyQixDQUF2QixDQU5YLENBQUE7QUFBQSxNQU9BLFVBQUEsR0FBYSxJQUFJLENBQUMsbUJBQUwsQ0FBQSxDQUFBLEdBQTZCLGdCQVAxQyxDQUFBO0FBQUEsTUFRQSxJQUFJLENBQUMsZ0JBQUwsQ0FBQSxDQVJBLENBQUE7QUFBQSxNQVNBLElBQUksQ0FBQyxJQUFMLENBQVUsbUJBQVYsQ0FBOEIsQ0FBQyxLQUEvQixDQUFBLENBVEEsQ0FBQTthQVVBLE1BQUEsQ0FBTyxHQUFHLENBQUMsR0FBWCxDQUFlLENBQUMsb0JBQWhCLENBQXFDLENBQUMsT0FBRCxFQUFVLFVBQVYsRUFBc0IsSUFBdEIsRUFBNEIsVUFBNUIsQ0FBckMsRUFBOEU7QUFBQSxRQUFBLEdBQUEsRUFBSyxJQUFJLENBQUMsbUJBQUwsQ0FBQSxDQUFMO09BQTlFLEVBWDZCO0lBQUEsQ0FBL0IsRUFEMkI7RUFBQSxDQUE3QixDQWZBLENBQUE7QUFBQSIKfQ==

//# sourceURL=/Users/dawsonbotsford/.atom/packages/git-plus/spec/views/select-stage-hunk-files-view-spec.coffee
